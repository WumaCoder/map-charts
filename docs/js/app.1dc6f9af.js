(function(e){function t(t){for(var r,o,s=t[0],c=t[1],u=t[2],l=0,f=[];l<s.length;l++)o=s[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(f.length)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={app:0},i=[];function o(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-2d216dc5":"de01cbe3"}[e]+".js"}function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=o(e);var u=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",u.name="ChunkLoadError",u.type=r,u.request=i,n[1](u)}a[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"073b":function(e,t,n){"use strict";n("d6f6")},1:function(e,t){},"1e51":function(e,t,n){},"2e15":function(e,t,n){"use strict";n("1e51")},3223:function(e,t,n){e.exports=n.p+"img/count.4d87e427.svg"},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-main",[n("MapCharts",{ref:"mc",attrs:{latitude:41.202626,longitude:111.778313,chartsTitle:e.chartsTitle,markers:e.markers,xAxisData:e.xAxisData},model:{value:e.select,callback:function(t){e.select=t},expression:"select"}})],1)],1)},i=[],o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-charts"},[n("div",{attrs:{id:"map"}}),n("Window",{attrs:{icon:e.countIcon}},[n("div",{ref:"charts",staticClass:"charts"})]),n("div",{staticClass:"select-box"},[n("div",{staticClass:"select-item"},[n("v-slider",{attrs:{step:"10","thumb-label":"",ticks:""},model:{value:e.slider,callback:function(t){e.slider=t},expression:"slider"}})],1),n("div",{staticClass:"select-item"},[n("v-select",{attrs:{items:e.mapCode,"item-text":"label","item-value":"value",label:"选择省份",dense:"",solo:""},model:{value:e.mapStat.province,callback:function(t){e.$set(e.mapStat,"province",t)},expression:"mapStat.province"}})],1),n("div",{staticClass:"select-item"},[n("v-select",{attrs:{items:e.levelCode,"item-text":"label","item-value":"value",label:"选择级别",dense:"",solo:""},model:{value:e.mapStat.level,callback:function(t){e.$set(e.mapStat,"level",t)},expression:"mapStat.level"}})],1),n("div",{staticClass:"select-item"},[n("v-select",{staticClass:"select-item",attrs:{items:e.statList,"item-text":"label","item-value":"value",label:"数据分布",dense:"",solo:""},model:{value:e.stat,callback:function(t){e.stat=t},expression:"stat"}})],1)])],1)},s=[],c=n("1da1"),u=n("2909"),l=(n("96cf"),n("a9e3"),n("d3b7"),n("6062"),n("3ca3"),n("ddb0"),n("d81d"),n("7db0"),n("4de4"),n("99af"),n("caad"),n("2532"),n("159b"),n("fb6a"),n("a434"),n("c740"),n("f269")),d=n("f4c8"),f=n("8f6d"),h=n("11aa"),p=n("5a01"),m=n("313e"),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"scope",class:{"scope-close":!e.moving&&!e.showScope},on:{mousemove:e.onMouseMove,mouseup:e.onMouseUp}},[n("div",{staticClass:"window",style:{left:this.left+"px",top:this.top+"px",width:e.width,height:e.height}},[n("div",{staticClass:"handle",on:{mousedown:e.onMouseDown,click:function(t){e.showBody=!e.showBody}}},[n("img",{attrs:{src:e.icon,draggable:"false"}})]),n("div",{staticClass:"tools"},e._l(e.menus,(function(e,t){return n("img",{key:t,staticClass:"tools-item",attrs:{src:e.icon},on:{click:e.handle}})})),0),n("div",{ref:"body",staticClass:"body"},[e._t("default")],2)])])},g=[],b={props:{width:String,height:String,icon:String,initLeft:Number,initTop:Number,menus:Array},data:function(){return{moving:!1,left:this.initLeft||0,top:this.initTop||0,downOffsetX:0,downOffsetY:0,showBody:!0,showScope:!1}},methods:{onMouseMove:function(e){this.moving&&(this.left=e.x-this.downOffsetX,this.top=e.y-this.downOffsetY)},onMouseDown:function(e){this.moving=!0,this.downOffsetX=e.offsetX+(this.$refs.body.clientWidth/2-7),this.downOffsetY=e.offsetY+(this.$refs.body.clientHeight-7)},onMouseUp:function(){this.moving=!1}}},x=b,w=(n("2e15"),n("2877")),y=Object(w["a"])(x,v,g,!1,null,"3eb3b970",null),M=y.exports,k={props:{longitude:Number,latitude:Number,defaultGaodeConfig:{type:Object,default:function(){return{pitch:40,style:"light",center:[121.435159,31.256971],zoom:6,token:"ba2513c38d63b973e454bc231ba1dbce"}}},markers:{type:Array,default:function(){return[]}},value:Array,chartsTitle:String,xAxisData:Array,onLoadSerie:{type:Function,default:function(e){return e.serie}},onLoadLine:{type:Function,default:function(e){return e.line}},selectItems:Array},components:{Window:M},data:function(){var e=this,t=!1;return{countIcon:n("3223"),mapCode:[],levelCode:[{label:"市级",value:2},{label:"县级",value:3}],statList:[{label:"请选择统计数据",value:-1},{label:"猪肉",value:0},{label:"羊肉",value:1},{label:"牛肉",value:2}],mapStat:{province:"",level:2},stat:-1,series:[],lines:[],select:this.value||[],slider:30,menus:[{icon:n("a39e"),handle:function(){t?e.mapStatLayer.hide():e.mapStatLayer.show(),t=!t}}]}},computed:{proxyValue:{get:function(){return this.value||this.select},set:function(e){e=Object(u["a"])(new Set(e)),this.select=e,this.$emit("input",e)}},selectedMarkers:function(){var e=this;return this.proxyValue.map((function(t){return e.markers.find((function(e){return e.id===t}))}))},chartsOption:function(){return{title:{text:this.chartsTitle,left:"center"},tooltip:{},xAxis:{data:this.xAxisData},yAxis:{},series:this.series}},innerMarkers:function(){var e=this;return this.markers.map((function(t){if(!t.innerMarker){var n=S(t,e.onClickMarker);Object.defineProperty(t,"innerMarker",{enumerable:!1,get:function(){return n}})}return t.innerMarker}))},location:function(){return this.longitude&&this.latitude?[this.longitude,this.latitude]:this.defaultGaodeConfig.center}},watch:{slider:function(e){this.proxyValue=this.innerMarkers.filter((function(t){return t.getExtData().data.value<=e})).map((function(e){return e.getExtData().data.id}))},stat:function(e){if(-1!==e){var t={2:j,3:R},n=t[this.mapStat.level](this.mapCode,this.mapStat.province).map((function(e){return e.value})).map((function(e){return{code:e,count:Math.floor(100*Math.random())}}));this.mapStatLayer.updateData(n)}},mapStat:{deep:!0,handler:function(e){var t,n={2:j,3:R},r=["orange","green","green"];this.stat=-1,null===(t=this.mapStatLayer)||void 0===t||t.destroy(),this.mapStatLayer=new h["a"](this.scene,{autoFit:!1,zIndex:-1,visible:!0,stroke:"red",data:[],joinBy:["adcode","code"],fill:{color:{field:"count",values:r}},label:{enable:!1,opacity:.8,textAllowOverlap:!1},popup:{Html:function(e){return"".concat(e.NAME_CHN,"<br>年产量：").concat(e.count,"只")}},depth:e.level,adcode:n[e.level](this.mapCode,e.province).map((function(e){return e.value}))})}},location:{immediate:!0,deep:!0,handler:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.waitMap();case 2:t.scene.setCenter(e);case 3:case"end":return n.stop()}}),n)})))()}},chartsOption:{immediate:!0,handler:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$nextTick();case 2:t.charts.setOption(e,{notMerge:!0,replaceMerge:["series"]});case 3:case"end":return n.stop()}}),n)})))()}},innerMarkers:{immediate:!0,handler:function(){var e=arguments,t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var r,a,i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:[],a=e.length>1&&void 0!==e[1]?e[1]:[],n.next=4,t.waitMap();case 4:i=a.filter((function(e){return!r.includes(e)})),o=r.filter((function(e){return!a.includes(e)})),i.forEach((function(e){return e.remove()})),o.forEach((function(e){t.scene.addMarker(e)}));case 8:case"end":return n.stop()}}),n)})))()}},selectedMarkers:{immediate:!0,handler:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$nextTick();case 2:t.markers.forEach((function(e){return t.checkMarker(e,!1)})),e.forEach((function(e){return t.checkMarker(e,!0)}));case 4:case"end":return n.stop()}}),n)})))()}}},methods:{initECharts:function(){return m["a"](this.$refs.charts)},initGaodeMap:function(){var e=this,t=new l["Scene"]({id:"map",map:new d["a"](this.defaultGaodeConfig)});return t.on("loaded",(function(){function n(){var e=this,n=new f["a"](t,{position:"topright",layout:"horizontal",controls:{polygon:!0,rect:!0,delete:!0}});n.on("draw.create",(function(t){var n=e.markers.filter((function(e){var n=t.feature.geometry.coordinates[0];return Object(p["a"])([e.longitude,e.latitude],n)}));e.proxyValue=n.map((function(e){return e.id}))})),t.addControl(n)}function r(){return a.apply(this,arguments)}function a(){return a=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}n.call(e),r.call(e)})),this.waitMapLoaded=function(){return new Promise((function(e){t.on("loaded",(function n(){e(),t.off("loaded",n)}))}))},t},waitMap:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$nextTick();case 2:return t.next=4,e.waitMapLoaded();case 4:case"end":return t.stop()}}),t)})))()},onClickMarker:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.select?t.proxyValue=[].concat(Object(u["a"])(t.proxyValue),[e.data.id]):(r=t.proxyValue.indexOf(e.data.id),a=t.proxyValue.slice(),a.splice(r,1),t.proxyValue=a);case 1:case"end":return n.stop()}}),n)})))()},checkMarker:function(e,t){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(C(e.innerMarker,t),!t){r.next=12;break}return r.next=4,n.onLoadSerie(e);case 4:return a=r.sent,n.addSerie(e,a),r.next=8,n.onLoadLine(e);case 8:i=r.sent,n.addLine(e,i),r.next=14;break;case 12:n.delSerie(e),n.delLine(e);case 14:case"end":return r.stop()}}),r)})))()},addSerie:function(e,t){t&&t.type?this.series.push(this.bindSerie(t,e)):console.warn("not serie")},delSerie:function(e){var t=this.series.findIndex((function(t){return e.serie===t||e.id==t.id}));-1!==t&&this.series.splice(t,1)},bindSerie:function(e,t){return t.id&&(e.id=t.id),e.itemStyle={color:t.color},e},addLine:function(e,t){t&&t.length?(this.lines.push(this.bindLine(t,e)),this.scene.addLayer(t.layer)):console.warn("not line")},delLine:function(e){var t=this.lines.findIndex((function(t){return e.line===t||e.id==t.id}));if(-1!==t){var n=this.lines[t];this.lines.splice(t,1),this.scene.removeLayer(n.layer)}},bindLine:function(e,t){t.id&&(e.id=t.id),t.color&&(e.color=t.color);var n=L(t);return e.layer=n,e},updateCharts:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=regeneratorRuntime.mark((function t(n){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.series[n],a=e.markers.find((function(e){return r===e.serie||"id"in e&&e.id===r.id})),!a){t.next=7;break}return t.next=5,e.onLoadSerie(a,a.innerMarker.getExtData());case 5:i=t.sent,e.$set(e.series,n,e.bindSerie(i,a));case 7:case"end":return t.stop()}}),t)})),r=0;case 2:if(!(r<e.series.length)){t.next=7;break}return t.delegateYield(n(r),"t0",4);case 4:r++,t.next=2;break;case 7:case"end":return t.stop()}}),t)})))()},onChangeSelect:function(){},onChangeProvinceSelect:function(e){console.log(R(this.mapCode,e)),this.mapStatLayer.updateDistrict(j(this.mapCode,e).map((function(e){return e.value})))},onChangeLevelSelect:function(){}},beforeCreate:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.e("chunk-2d216dc5").then(n.bind(null,"c3ed")).then((function(e){return e.default}));case 2:e.mapCode=t.sent;case 3:case"end":return t.stop()}}),t)})))()},mounted:function(){this.charts=this.initECharts(),this.scene=this.initGaodeMap()},destroyed:function(){this.charts.dispose(),this.scene.destroy()}};function S(e,t){var n={select:!1,data:e},r=new l["Marker"]({extData:n,element:O(e),offsets:[0,10]}).setLnglat({lng:e.longitude,lat:e.latitude});return r.on("click",(function(e){C(r),t(e.data)})),r}function C(e,t){var n=e.getExtData(),r=e.getElement().classList;n.select="boolean"===typeof t?t:!n.select,r.toggle("select",n.select)}function O(e){var t=e.text,n=e.color,r=document.createElement("div");r.className="marker";var a=document.createElement("div");a.className="marker-text",a.textContent=t;var i=document.createElement("div");return i.style.background=n,i.className="marker-point",r.appendChild(a),r.appendChild(i),r}function L(e){var t=new l["LineLayer"]({zIndex:1,blend:"max"}).source(e.line,{parser:{type:"json",coordinates:"path"}}).color(e.color).shape("arc3d").size(3).active(!0).animate({interval:2,trailLength:2,duration:1}).style({opacity:1});return t}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.find((function(e){return e.value===t})).children}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.find((function(e){return e.value===t})).children.reduce((function(e,t){return e=e.concat(t.children),e}),[])}var E=k,A=(n("073b"),n("6544")),T=n.n(A),_=n("b974"),D=n("ba0d"),$=Object(w["a"])(E,o,s,!1,null,null,null),V=$.exports;T()($,{VSelect:_["a"],VSlider:D["a"]});var P={name:"App",components:{MapCharts:V},data:function(){return{chartsTitle:"数据图表",xAxisData:["2010","2011","2012","2013"],select:[],markers:[{id:1,text:"测试1",color:"blue",value:10,longitude:111.778313,latitude:41.202626,serie:{type:"line",data:[Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random())]},line:[{path:[[111.778313,41.202626],[116.414543,43.67502]]},{path:[[111.778313,41.202626],[121.512199,45.720751]]}]},{id:2,text:"测试2",color:"yellow",longitude:116.414543,latitude:43.67502,value:20,serie:{type:"line",data:[Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random())]}},{id:3,text:"测试3",color:"red",longitude:109.537102,latitude:40.245149,value:30,serie:{type:"line",data:[Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random())]}},{id:4,text:"测试4",color:"green",longitude:121.512199,latitude:45.720751,value:30,serie:{type:"bar",data:[Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random())]},line:[{path:[[121.512199,45.720751],[111.778313,41.202626]]},{path:[[111.778313,41.202626],[109.537102,40.245149]]}]}]}},watch:{select:function(e){console.log(e)}},methods:{onLoadSerie:function(){return{type:"line",data:[Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random()),Math.floor(100*Math.random())]}}},created:function(){}},N=P,I=n("7496"),z=n("f6c4"),G=Object(w["a"])(N,a,i,!1,null,null,null),Y=G.exports;T()(G,{VApp:I["a"],VMain:z["a"]});var B=n("f309");r["a"].use(B["a"]);var X=new B["a"]({});r["a"].config.productionTip=!1,new r["a"]({vuetify:X,render:function(e){return e(Y)}}).$mount("#app")},a39e:function(e,t,n){e.exports=n.p+"img/fb.fbf68d08.svg"},d6f6:function(e,t,n){}});
//# sourceMappingURL=app.1dc6f9af.js.map